@startuml

title High-Level Real-Time Payment Architecture

skinparam componentStyle rectangle

package "Channel / API Layer" {
  [Channel Client] as Channel
}

package "Orchestration Layer" {
  [PaymentOrchestrator] as Orchestrator
  [PaymentOrchestrationContext] as Context
  [PaymentLifecycleManager] as Lifecycle
}

package "Domain & ISO 20022 Layer" {
  [Iso20022CreditTransfer] as CreditTransfer
  [Iso20022MessageFactory] as MsgFactory
  [Iso20022SchemaValidator] as SchemaValidator
}

package "Validation Layer" {
  [PaymentValidator] as PaymentValidator
  [AmountValidator] as AmountValidator
  [AccountStatusValidator] as AccountStatusValidator
  [SanctionsScreeningValidator] as SanctionsValidator
}

package "Routing Layer" {
  [PaymentRouter] as PaymentRouter
  [SchemeRouter] as SchemeRouter
  [BankRouter] as BankRouter
}

package "Service Layer" {
  [FraudCheckService] as FraudService
  [RiskScoringService] as RiskService
  [PostingService] as PostingService
  [NotificationService] as NotificationService
  [AuditService] as AuditService
  [LedgerService] as LedgerService
  [EventPublisher] as EventPublisher
}

Channel --> Orchestrator : initiatePayment()
Orchestrator --> Context : create/update
Orchestrator --> PaymentValidator : validate()
PaymentValidator --> AmountValidator
PaymentValidator --> AccountStatusValidator
PaymentValidator --> SanctionsValidator

Orchestrator --> MsgFactory : buildMessage()
Orchestrator --> SchemaValidator : validateISO20022()
SchemaValidator --> CreditTransfer

Orchestrator --> FraudService : evaluate()
Orchestrator --> RiskService : score()

Orchestrator --> PaymentRouter : selectRoute()
PaymentRouter --> SchemeRouter
PaymentRouter --> BankRouter

Orchestrator --> PostingService : postToLedger()
PostingService --> LedgerService

Orchestrator --> NotificationService : notifyParties()
Orchestrator --> AuditService : recordLifecycle()
Orchestrator --> EventPublisher : publishEvents()

@enduml
